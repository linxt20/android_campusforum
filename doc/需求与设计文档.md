# 需求与设计文档——小蓝站app
小组成员： 
林欣涛 2020012356 张雨恬 2020012392 汪静雅 2020012375
## 原型设计
本小组结合大作业文档的功能需求，为大作业的总体UI与功能安排做出了一份简单原型设计，链接如下：
https://modao.cc/app/1Jj3Dyt3rt0do85bEFvrNp

## 功能介绍

### 小蓝站的功能定位
小蓝站app作为一个校园生活的信息中心，为学生提供一个方便、实用且互动性强的平台。它帮助学生分享校园趣事、交流动态、发布二手交易等，促进校园内的信息传播和交流。通过提供丰富的功能和便捷的操作，小蓝站app为学生们打造了一个贴近校园生活的互动社区，满足了他们在学习、生活和娱乐等方面的需求。

### 功能清单与解读
1. 用户注册与登录
- 允许用户创建一个新帐号并设置登录密码，提供个性化的用户体验。
- 用户可以随时修改他们的个人资料，包括用户名、头像、个人简介和密码，以保持个人信息的准确性和更新。
- 用户可以关注或取消关注其他用户，建立社交关系。关注列表会展示所有关注的用户，方便查看关注用户的动态。
- 用户可以屏蔽其他用户，确保信息查看界面中不会出现不希望看到的内容，提升用户浏览体验。

2. 私信
- 用户可以在其他用户的个人主页上发起私信，支持发送文字内容，增加用户之间的互动和沟通。
- 收到私信的用户可以进行回复，与发起者保持联系，并以聊天栏的形式显示历史私信记录，方便回顾和查找。

3. 二级菜单
- 在个人主页上，用户可以看到他们发布的所有信息，按照发布时间排序，便于用户回顾自己的动态。
- 用户可以通过点击其他用户的头像或用户名，从信息浏览界面或评论界面进入他人的个人主页，了解他人的动态和信息。

4. 信息发布
- 用户可以发布不同类型的信息，包括纯文字、带图片的文字信息以及带视频的文字信息。图片和视频可以从相册中选择或通过相机拍摄，提供丰富的信息呈现形式。
- 用户可以在发布信息时调用位置信息API获取当前位置，并将位置信息附加到发布的信息中，方便展示信息的相关地理位置。
- 用户可以为发布的信息指定类型，如校园资讯、二手交易等，便于其他用户快速找到感兴趣的信息。
- 用户可以修改文字内容的字体大小、颜色、粗细等格式，或选择支持部分Markdown格式标记，如多级标题、列表、文字加粗等，提高信息的可读性和美观度。

5. 信息查看与操作
- 用户可以根据信息的发布者、热度（点赞评论量高）或信息类型等属性对信息进行分类浏览，快速找到感兴趣的内容。
- 用户可以根据信息的发布时间、点赞量或评论量进行排序，以便查看最相关或最热门的信息。
- 用户可以对发布的信息进行点赞或取消点赞，以表达他们对内容的喜好。同时，用户还可以将信息收藏或取消收藏，以便日后查看。
- 用户可以对发布的信息发表文字评论，与其他用户互动交流，增强社交属性。
- 用户可以将信息标题或内容分享到其他可展示内容的APP中，扩大信息传播范围，提高信息的影响力。
- 在信息详情页面显示完整内容，包括富文本格式。此外，页面还会显示点赞收藏数以及所有评论信息，评论按时间排序，便于用户查看详情和参与互动。

6. UI设计与交互
- 实现的APP应包含完整的界面和合理的跳转交互，至少包括：信息浏览界面、信息详情界面（包含评论）、信息发布界面、个人中心（设置）界面、收藏信息列表界面、个人主页及他人主页（按时间线展示用户发布信息）、私信界面、关注与被关注的用户列表界面。提供清晰的界面设计和流畅的用户体验。
- 在内容加载或界面切换时使用动画：为提高用户体验，使用动画效果展示内容加载过程或在界面切换时的过渡，使APP更具吸引力和活力。

## 技术实现

### 项目总体框架
前端采用android studio进行设计，后端使用spring boot框架进行搭建，数据库使用mongodb，前后端通信基于okhttp

### 功能点的技术实现计划

#### 底层数据库规划
1、用户表（users）：
- id（主键）、username（用户名）、password_hash（密码哈希）、email（邮箱，可选）、avatar_url（头像链接）、bio（个人简介）、create_time（创建时间）、update_time（更新时间）、blocked_users（屏蔽用户列表）、关注列表（follows）、被关注列表（followers）。
- 目标功能：用户注册、登录、修改信息、关注/取消关注、屏蔽/取消屏蔽用户。
2、私信表（messages）：
- id（主键）、sender_id（发送者ID）、receiver_id（接收者ID）、content（内容）、send_time（发送时间）。
- 目标功能：发送私信、查看私信。
3、信息表（posts）：
- id（主键）、user_id（发布者ID）、content（内容）、post_type（类型：校园资讯/二手交易等）、image_url（图片链接，可选）、video_url（视频链接，可选）、location（位置，可选）、create_time（发布时间）、update_time（更新时间）、likes_count（点赞数量）、comments_count（评论数量）。
- 目标功能：发布信息、查看信息、分类浏览、排序。
4、点赞表（likes）：
- id（主键）、user_id（点赞者ID）、post_id（信息ID）、create_time（点赞时间）。
- 目标功能：点赞/取消点赞。
5、收藏表（favorites）：
- id（主键）、user_id（收藏者ID）、post_id（信息ID）、create_time（收藏时间）。
- 目标功能：收藏/取消收藏。
6、评论表（comments）：
- id（主键）、user_id（评论者ID）、post_id（信息ID）、content（评论内容）、create_time（评论时间）。
- 目标功能：评论信息。

#### 部分细节功能的实现规划
1、用户屏蔽操作实现：
- 在用户表中为每个用户添加一个blocked_users字段，存储已屏蔽用户的ID列表。
- 当用户屏蔽某个用户时，在blocked_users中添加被屏蔽用户的ID;当用户取消屏蔽时，从blocked_users中移除被屏蔽用户的ID。
- 在获取信息列表时，根据用户的blocked_users列表，过滤掉被屏蔽用户发布的信息。

2、私信采用WebSocket和MongoDB实现的方案流程：
- 前端：使用WebSocket与后端建立实时通信连接。
- 后端：在Spring Boot中使用WebSocket实现实时通信功能，并在接收到私信消息时将其存储到MongoDB的私信表中。
- 当用户打开私信界面时，后端从MongoDB中获取历史私信记录，按时间顺序返回给前端。
- 当用户发送私信时，前端通过WebSocket将消息发送给后端，后端将消息存储到MongoDB，并将消息转发给对应的接收者。

3、信息发布中的实现细节：
- 使用相册/相机：使用Android的相册和相机API，让用户选择或拍摄图片/视频。选取完成后，将文件上传至服务器并获得图片/视频的URL，将URL存储到信息表的对应字段中。
- 位置信息：使用定位API（如Google Maps API或高德地图API）获取当前位置信息，将位置信息存储到信息表的location字段中。
- 支持Markdown格式标记：使用前端Markdown编辑器（如simplemde或mavonEditor）实现用户输入的Markdown格式文本编辑功能。将编辑好的Markdown文本存储到信息表的content字段中，前端使用Markdown渲染库（如markdown-it）将Markdown文本转换成HTML展示给用户。

4、信息分享的技术实现方案：
- 使用HTML5的Clipboard API实现将Markdown格式的内容复制到剪贴板。
- 使用社交分享库（如ShareSDK）实现将Markdown格式的内容分享到其他可展示内容的APP中。

## 阶段小结
在这个阶段，我们针对小蓝站APP完成了以下工作：
- 设计原型：根据功能需求，我们设计了一个初步的APP原型，包括各个界面的布局、UI元素和交互。
- 需求与设计文档：我们详细解读了每个功能点的需求，包括用户注册与登录、私信、二级菜单、信息发布、信息查看与操作以及UI设计与交互。同时规划了技术方案，包括使用Android Studio进行前端设计，采用Spring Boot框架搭建后端服务，以及基于okhttp实现前后端连接。
- 实现前后端连接：通过设计和实现RESTful API，我们将前端与后端连接起来，实现了用户界面与后端服务的数据交互。
- 数据库连接：根据功能需求，我们规划了数据库的表结构，包括用户表、私信表、信息表、点赞表、收藏表和评论表。同时，我们实现了与数据库的连接，使后端服务能够对数据库进行查询和修改操作。
至此，我们已经完成了小蓝站APP的一个阶段性成果，为下一阶段的开发工作打下了基础。后续工作将继续优化原型设计、完善功能实现，并对性能和安全性进行调整和改进。